diff --git a/bin/asdf b/bin/asdf
index a0962d8..6398159 100755
--- a/bin/asdf
+++ b/bin/asdf
@@ -29,7 +29,7 @@ find_cmd() {
 
 find_asdf_cmd() {
   local asdf_cmd_dir
-  asdf_cmd_dir="$(asdf_dir)/lib/commands"
+  asdf_cmd_dir="$ASDF_DIR/lib/commands"
   case "$1" in
   'exec' | 'current' | 'env' | 'global' | 'install' | 'latest' | 'local' | \
     'reshim' | 'uninstall' | 'update' | 'where' | 'which' | \
@@ -72,17 +72,17 @@ asdf_cmd() {
   fi
 
   # Internal Variables
-  ASDF_DEFAULT_TOOL_VERSIONS_FILENAME=$(asdf_tool_versions_filename)
-  export ASDF_DEFAULT_TOOL_VERSIONS_FILENAME
+  get_asdf_tool_versions_filename
+  export ASDF_DEFAULT_TOOL_VERSIONS_FILENAME=$REPLY
 
-  ASDF_CONFIG_FILE=$(asdf_config_file)
-  export ASDF_CONFIG_FILE
+  get_asdf_config_file
+  export ASDF_CONFIG_FILE=$REPLY
 
-  ASDF_DATA_DIR=$(asdf_data_dir)
-  export ASDF_DATA_DIR
+  get_asdf_data_dir
+  export ASDF_DATA_DIR=$REPLY
 
-  ASDF_DIR=$(asdf_dir)
-  export ASDF_DIR
+  get_asdf_dir
+  export ASDF_DIR=$REPLY
 
   local result=
   result="$(find_asdf_cmd "$@")"
@@ -113,8 +113,7 @@ asdf_cmd() {
     # shellcheck source=/dev/null
     . "$ASDF_CMD_FILE"
   else
-    local asdf_cmd_dir
-    asdf_cmd_dir="$(asdf_dir)/lib/commands"
+    local asdf_cmd_dir="$ASDF_DIR/lib/commands"
     printf "%s\n" "Unknown command: \`asdf ${*}\`" >&2
     # shellcheck source=lib/commands/command-help.bash
     . "$asdf_cmd_dir/command-help.bash" >&2
diff --git a/bin/private/asdf-exec b/bin/private/asdf-exec
index f339a62..bc5f053 100755
--- a/bin/private/asdf-exec
+++ b/bin/private/asdf-exec
@@ -6,7 +6,7 @@ printf "asdf is self upgrading shims to new asdf exec ...\\n"
 asdf_dir="${0%/*/*/*}"
 # shellcheck source=lib/utils.bash
 . "$asdf_dir/lib/utils.bash"
-rm "$(asdf_data_dir)"/shims/*
+rm "$ASDF_DATA_DIR"/shims/*
 "$asdf_dir"/bin/asdf reshim
 shim_name=${2%/}
 shim_name=${shim_name##*/}
diff --git a/lib/commands/command-help.bash b/lib/commands/command-help.bash
index 5453185..e5185b9 100644
--- a/lib/commands/command-help.bash
+++ b/lib/commands/command-help.bash
@@ -4,7 +4,7 @@
 
 asdf_help() {
   printf "version: %s\n\n" "$(asdf_version)"
-  cat "$(asdf_dir)/help.txt"
+  cat "$ASDF_DIR/help.txt"
 }
 
 asdf_moto() {
diff --git a/lib/commands/command-plugin-list-all.bash b/lib/commands/command-plugin-list-all.bash
index 29425d9..31a1d76 100644
--- a/lib/commands/command-plugin-list-all.bash
+++ b/lib/commands/command-plugin-list-all.bash
@@ -4,7 +4,7 @@ plugin_list_all_command() {
   initialize_or_update_plugin_repository
 
   local plugins_index_path
-  plugins_index_path="$(asdf_data_dir)/repository/plugins"
+  plugins_index_path="$ASDF_DATA_DIR/repository/plugins"
 
   local plugins_local_path
   plugins_local_path="$(get_plugin_path)"
diff --git a/lib/commands/command-plugin-push.bash b/lib/commands/command-plugin-push.bash
index 6136a10..8a8726b 100644
--- a/lib/commands/command-plugin-push.bash
+++ b/lib/commands/command-plugin-push.bash
@@ -3,7 +3,7 @@
 plugin_push_command() {
   local plugin_name=$1
   if [ "$plugin_name" = "--all" ]; then
-    for dir in "$(asdf_data_dir)"/plugins/*/; do
+    for dir in "$ASDF_DATA_DIR"/plugins/*/; do
       local dirname=${dir%/}
       dirname=${dirname##*/}
       printf "Pushing %s...\n" "$dirname"
diff --git a/lib/commands/command-plugin-remove.bash b/lib/commands/command-plugin-remove.bash
index 7b959bd..4020cca 100644
--- a/lib/commands/command-plugin-remove.bash
+++ b/lib/commands/command-plugin-remove.bash
@@ -18,10 +18,10 @@ plugin_remove_command() {
   fi
 
   rm -rf "$plugin_path"
-  rm -rf "$(asdf_data_dir)/installs/${plugin_name}"
-  rm -rf "$(asdf_data_dir)/downloads/${plugin_name}"
+  rm -rf "$ASDF_DATA_DIR/installs/${plugin_name}"
+  rm -rf "$ASDF_DATA_DIR/downloads/${plugin_name}"
 
-  for f in "$(asdf_data_dir)"/shims/*; do
+  for f in "$ASDF_DATA_DIR"/shims/*; do
     if [ -f "$f" ]; then # nullglob may not be set
       if grep -q "asdf-plugin: ${plugin_name}" "$f"; then
         rm -f "$f"
diff --git a/lib/commands/command-plugin-test.bash b/lib/commands/command-plugin-test.bash
index 791ff5f..6572a14 100644
--- a/lib/commands/command-plugin-test.bash
+++ b/lib/commands/command-plugin-test.bash
@@ -68,9 +68,9 @@ plugin_test_command() {
   fi
 
   TEST_DIR=$(mktemp -dt asdf.XXXX)
-  cp -R "$(asdf_dir)/bin" "$TEST_DIR"
-  cp -R "$(asdf_dir)/lib" "$TEST_DIR"
-  cp "$(asdf_dir)/asdf.sh" "$TEST_DIR"
+  cp -R "$ASDF_DIR/bin" "$TEST_DIR"
+  cp -R "$ASDF_DIR/lib" "$TEST_DIR"
+  cp "$ASDF_DIR/asdf.sh" "$TEST_DIR"
 
   plugin_test() {
     export ASDF_DIR=$TEST_DIR
diff --git a/lib/commands/command-update.bash b/lib/commands/command-update.bash
index f991264..3b37743 100644
--- a/lib/commands/command-update.bash
+++ b/lib/commands/command-update.bash
@@ -4,7 +4,7 @@ update_command() {
   local update_to_head=$1
 
   (
-    cd "$(asdf_dir)" || exit 1
+    cd "$ASDF_DIR" || exit 1
 
     if [ -f asdf_updates_disabled ] || ! git rev-parse --is-inside-work-tree &>/dev/null; then
       printf "Update command disabled. Please use the package manager that you used to install asdf to upgrade asdf.\n"
diff --git a/lib/commands/reshim.bash b/lib/commands/reshim.bash
index 82e6614..040edb7 100644
--- a/lib/commands/reshim.bash
+++ b/lib/commands/reshim.bash
@@ -7,7 +7,7 @@ remove_shim_for_version() {
   shim_name=${shim_name##*/}
 
   local shim_path
-  shim_path="$(asdf_data_dir)/shims/$shim_name"
+  shim_path="$ASDF_DATA_DIR/shims/$shim_name"
 
   local count_installed
   count_installed=$(list_installed_versions "$plugin_name" | wc -l)
@@ -54,7 +54,7 @@ reshim_command() {
   else
     # generate for all versions of the package
     local plugin_installs_path
-    plugin_installs_path="$(asdf_data_dir)/installs/${plugin_name}"
+    plugin_installs_path="$ASDF_DATA_DIR/installs/${plugin_name}"
 
     for install in "${plugin_installs_path}"/*/; do
       local full_version_name
@@ -70,8 +70,8 @@ reshim_command() {
 
 ensure_shims_dir() {
   # Create shims dir if doesn't exist
-  if [ ! -d "$(asdf_data_dir)/shims" ]; then
-    mkdir "$(asdf_data_dir)/shims"
+  if [ ! -d "$ASDF_DATA_DIR/shims" ]; then
+    mkdir "$ASDF_DATA_DIR/shims"
   fi
 }
 
@@ -89,7 +89,7 @@ write_shim_script() {
   executable_name=${executable_name##*/}
 
   local shim_path
-  shim_path="$(asdf_data_dir)/shims/$executable_name"
+  shim_path="$ASDF_DATA_DIR/shims/$executable_name"
 
   local temp_dir
   temp_dir=${TMPDIR:-/tmp}
@@ -107,7 +107,7 @@ EOF
   cat <<EOF >"$shim_path"
 #!/usr/bin/env bash
 $(sort -u <"$temp_versions_path")
-exec $(asdf_dir)/bin/asdf exec "${executable_name}" "\$@" # asdf_allow: ' asdf '
+exec $ASDF_DIR/bin/asdf exec "${executable_name}" "\$@" # asdf_allow: ' asdf '
 EOF
 
   rm "$temp_versions_path"
diff --git a/lib/functions/plugins.bash b/lib/functions/plugins.bash
index ab6bd54..733f522 100644
--- a/lib/functions/plugins.bash
+++ b/lib/functions/plugins.bash
@@ -77,7 +77,7 @@ plugin_add_command() {
   local plugin_path
   plugin_path=$(get_plugin_path "$plugin_name")
 
-  [ -d "$(asdf_data_dir)/plugins" ] || mkdir -p "$(asdf_data_dir)/plugins"
+  [ -d "$ASDF_DATA_DIR/plugins" ] || mkdir -p "$ASDF_DATA_DIR/plugins"
 
   if [ -d "$plugin_path" ]; then
     printf '%s\n' "Plugin named $plugin_name already added"
@@ -115,8 +115,8 @@ plugin_update_command() {
   local plugins=
 
   if [ "$plugin_name" = "--all" ]; then
-    if [ -d "$(asdf_data_dir)"/plugins ]; then
-      plugins=$(find "$(asdf_data_dir)"/plugins -mindepth 1 -maxdepth 1 -type d)
+    if [ -d "$ASDF_DATA_DIR"/plugins ]; then
+      plugins=$(find "$ASDF_DATA_DIR"/plugins -mindepth 1 -maxdepth 1 -type d)
       while IFS= read -r dir; do
         local dirname=${dir%/}
         dirname=${dirname##*/}
diff --git a/lib/functions/versions.bash b/lib/functions/versions.bash
index ccf0e88..fad21ea 100644
--- a/lib/functions/versions.bash
+++ b/lib/functions/versions.bash
@@ -14,11 +14,9 @@ version_command() {
   shift 2
   local versions=("$@")
 
-  local file_name
+  local file_name=$ASDF_DEFAULT_TOOL_VERSIONS_FILENAME
   local file
 
-  file_name="$(asdf_tool_versions_filename)"
-
   if [ "$cmd" = "global" ]; then
     file="$HOME/$file_name"
   elif [ "$cmd" = "local-tree" ]; then
diff --git a/lib/utils.bash b/lib/utils.bash
index 5979974..00321b4 100644
--- a/lib/utils.bash
+++ b/lib/utils.bash
@@ -7,46 +7,50 @@ GREP_COLORS=
 
 asdf_version() {
   local version git_rev
-  version="v$(cat "$(asdf_dir)/version.txt")"
-  if [ -d "$(asdf_dir)/.git" ]; then
-    git_rev="$(git --git-dir "$(asdf_dir)/.git" rev-parse --short HEAD)"
+  version="v$(<"$ASDF_DIR/version.txt")"
+  if [ -d "$ASDF_DIR/.git" ]; then
+    git_rev="$(git --git-dir "$ASDF_DIR/.git" rev-parse --short HEAD)"
     printf "%s-%s\n" "$version" "$git_rev"
   else
     printf "%s\n" "$version"
   fi
 }
 
-asdf_tool_versions_filename() {
-  printf '%s\n' "${ASDF_DEFAULT_TOOL_VERSIONS_FILENAME:-.tool-versions}"
+get_asdf_tool_versions_filename() {
+  unset -v REPLY
+  REPLY="${ASDF_DEFAULT_TOOL_VERSIONS_FILENAME:-.tool-versions}"
 }
 
-asdf_config_file() {
-  printf '%s\n' "${ASDF_CONFIG_FILE:-$HOME/.asdfrc}"
+get_asdf_config_file() {
+  unset -v REPLY
+  REPLY="${ASDF_CONFIG_FILE:-$HOME/.asdfrc}"
 }
 
-asdf_data_dir() {
-  local data_dir
+get_asdf_data_dir() {
+  unset -v REPLY
 
   if [ -n "${ASDF_DATA_DIR}" ]; then
-    data_dir="${ASDF_DATA_DIR}"
+    REPLY="${ASDF_DATA_DIR}"
   elif [ -n "$HOME" ]; then
-    data_dir="$HOME/.asdf"
+    REPLY="$HOME/.asdf"
   else
-    data_dir=$(asdf_dir)
+    get_asdf_dir
+    # shellcheck disable=SC2269
+    REPLY=$REPLY
   fi
-
-  printf "%s\n" "$data_dir"
 }
 
-asdf_dir() {
+get_asdf_dir() {
+  unset -v REPLY
+
   if [ -z "$ASDF_DIR" ]; then
     local current_script_path=${BASH_SOURCE[0]}
-    printf '%s\n' "$(
+    REPLY=$(
       cd -- "$(dirname "$(dirname "$current_script_path")")" || exit
       printf '%s\n' "$PWD"
-    )"
+    )
   else
-    printf '%s\n' "$ASDF_DIR"
+    REPLY="$ASDF_DIR"
   fi
 }
 
@@ -60,7 +64,7 @@ get_install_path() {
   local version=$3
 
   local install_dir
-  install_dir="$(asdf_data_dir)/installs"
+  install_dir="$ASDF_DATA_DIR/installs"
 
   [ -d "${install_dir}/${plugin}" ] || mkdir -p "${install_dir}/${plugin}"
 
@@ -79,7 +83,7 @@ get_download_path() {
   local version=$3
 
   local download_dir
-  download_dir="$(asdf_data_dir)/downloads"
+  download_dir="$ASDF_DATA_DIR/downloads"
 
   [ -d "${download_dir}/${plugin}" ] || mkdir -p "${download_dir}/${plugin}"
 
@@ -98,7 +102,7 @@ list_installed_versions() {
   plugin_path=$(get_plugin_path "$plugin_name")
 
   local plugin_installs_path
-  plugin_installs_path="$(asdf_data_dir)/installs/${plugin_name}"
+  plugin_installs_path="$ASDF_DATA_DIR/installs/${plugin_name}"
 
   if [ -d "$plugin_installs_path" ]; then
     for install in "${plugin_installs_path}"/*/; do
@@ -117,7 +121,7 @@ check_if_plugin_exists() {
     exit 1
   fi
 
-  if [ ! -d "$(asdf_data_dir)/plugins/$plugin_name" ]; then
+  if [ ! -d "$ASDF_DATA_DIR/plugins/$plugin_name" ]; then
     display_error "No such plugin: $plugin_name"
     exit 1
   fi
@@ -146,9 +150,9 @@ version_not_installed_text() {
 
 get_plugin_path() {
   if [ -n "$1" ]; then
-    printf "%s\n" "$(asdf_data_dir)/plugins/$1"
+    printf "%s\n" "$ASDF_DATA_DIR/plugins/$1"
   else
-    printf "%s\n" "$(asdf_data_dir)/plugins"
+    printf "%s\n" "$ASDF_DATA_DIR/plugins"
   fi
 }
 
@@ -163,7 +167,7 @@ get_version_in_dir() {
 
   local asdf_version
 
-  file_name=$(asdf_tool_versions_filename)
+  local file_name=$ASDF_DEFAULT_TOOL_VERSIONS_FILENAME
   asdf_version=$(parse_asdf_version_file "$search_path/$file_name" "$plugin_name")
 
   if [ -n "$asdf_version" ]; then
@@ -300,7 +304,7 @@ get_executable_path() {
   check_if_version_exists "$plugin_name" "$version"
 
   if [ "$version" = "system" ]; then
-    path=$(remove_path_from_path "$PATH" "$(asdf_data_dir)/shims")
+    path=$(remove_path_from_path "$PATH" "$ASDF_DATA_DIR/shims")
     cmd=${executable_path%/}
     cmd=${cmd##*/}
     cmd_path=$(PATH=$path command -v "$cmd" 2>&1)
@@ -389,9 +393,8 @@ get_asdf_config_value_from_file() {
 
 get_asdf_config_value() {
   local key=$1
-  local config_path=
-  config_path=$(asdf_config_file)
-  local default_config_path=${ASDF_CONFIG_DEFAULT_FILE:-"$(asdf_dir)/defaults"}
+  local config_path="$ASDF_CONFIG_FILE"
+  local default_config_path=${ASDF_CONFIG_DEFAULT_FILE:-"$ASDF_DIR/defaults"}
 
   local local_config_path
   local_config_path="$(find_file_upwards ".asdfrc")"
@@ -413,7 +416,7 @@ repository_needs_update() {
   if [ "never" != "$plugin_repository_last_check_duration" ]; then
     local update_file_dir
     local update_file_name
-    update_file_dir="$(asdf_data_dir)/tmp"
+    update_file_dir="$ASDF_DATA_DIR/tmp"
     update_file_name="repo-updated"
     # `find` outputs filename if it has not been modified in plugin_repository_last_check_duration setting.
     sync_required=$(find "$update_file_dir" -name "$update_file_name" -type f -mmin +"${plugin_repository_last_check_duration:-60}" -print)
@@ -433,7 +436,7 @@ initialize_or_update_plugin_repository() {
   fi
 
   repository_url=$(asdf_plugin_repository_url)
-  repository_path=$(asdf_data_dir)/repository
+  repository_path=$ASDF_DATA_DIR/repository
 
   if [ ! -d "$repository_path" ]; then
     printf "initializing plugin repository..."
@@ -444,15 +447,15 @@ initialize_or_update_plugin_repository() {
     git -C "$repository_path" reset --hard origin/master
   fi
 
-  [ -d "$(asdf_data_dir)/tmp" ] || mkdir -p "$(asdf_data_dir)/tmp"
-  touch "$(asdf_data_dir)/tmp/repo-updated"
+  [ -d "$ASDF_DATA_DIR/tmp" ] || mkdir -p "$ASDF_DATA_DIR/tmp"
+  touch "$ASDF_DATA_DIR/tmp/repo-updated"
 }
 
 get_plugin_source_url() {
   local plugin_name=$1
   local plugin_config
 
-  plugin_config="$(asdf_data_dir)/repository/plugins/$plugin_name"
+  plugin_config="$ASDF_DATA_DIR/repository/plugins/$plugin_name"
 
   if [ -f "$plugin_config" ]; then
     grep "repository" "$plugin_config" | awk -F'=' '{print $2}' | sed 's/ //'
@@ -460,7 +463,8 @@ get_plugin_source_url() {
 }
 
 find_tool_versions() {
-  find_file_upwards "$(asdf_tool_versions_filename)"
+  local file_name=$ASDF_DEFAULT_TOOL_VERSIONS_FILENAME
+  find_file_upwards "$file_name"
 }
 
 find_file_upwards() {
@@ -637,7 +641,7 @@ is_executable() {
 plugin_shims() {
   local plugin_name=$1
   local full_version=$2
-  grep -lx "# asdf-plugin: $plugin_name $full_version" "$(asdf_data_dir)/shims"/* 2>/dev/null
+  grep -lx "# asdf-plugin: $plugin_name $full_version" "$ASDF_DATA_DIR/shims"/* 2>/dev/null
 }
 
 shim_plugin_versions() {
@@ -645,7 +649,7 @@ shim_plugin_versions() {
   executable_name=${1%/}
   executable_name=${executable_name##*/}
   local shim_path
-  shim_path="$(asdf_data_dir)/shims/${executable_name}"
+  shim_path="$ASDF_DATA_DIR/shims/${executable_name}"
   if [ -x "$shim_path" ]; then
     grep "# asdf-plugin: " "$shim_path" 2>/dev/null | sed -e "s/# asdf-plugin: //" | uniq
   else
@@ -659,7 +663,7 @@ shim_plugins() {
   executable_name=${1%/}
   executable_name=${executable_name##*/}
   local shim_path
-  shim_path="$(asdf_data_dir)/shims/${executable_name}"
+  shim_path="$ASDF_DATA_DIR/shims/${executable_name}"
   if [ -x "$shim_path" ]; then
     grep "# asdf-plugin: " "$shim_path" 2>/dev/null | sed -e "s/# asdf-plugin: //" | cut -d' ' -f 1 | uniq
   else
@@ -701,7 +705,7 @@ get_shim_versions() {
 
 preset_versions() {
   shim_name=$1
-  shim_plugin_versions "${shim_name}" | cut -d' ' -f 1 | uniq | xargs -IPLUGIN bash -c ". $(asdf_dir)/lib/utils.bash; printf \"%s %s\n\" PLUGIN \$(get_preset_version_for PLUGIN)"
+  shim_plugin_versions "${shim_name}" | cut -d' ' -f 1 | uniq | xargs -IPLUGIN bash -c ". $ASDF_DIR/lib/utils.bash; printf \"%s %s\n\" PLUGIN \$(get_preset_version_for PLUGIN)"
 }
 
 select_from_preset_version() {
@@ -765,7 +769,7 @@ with_shim_executable() {
   shim_name=${shim_name##*/}
   local shim_exec="${2}"
 
-  if [ ! -f "$(asdf_data_dir)/shims/${shim_name}" ]; then
+  if [ ! -f "$ASDF_DATA_DIR/shims/${shim_name}" ]; then
     printf "%s %s %s\n" "unknown command:" "${shim_name}." "Perhaps you have to reshim?" >&2
     return 1
   fi
@@ -789,7 +793,7 @@ with_shim_executable() {
     # shellcheck disable=SC2317
     run_within_env() {
       local path
-      path=$(remove_path_from_path "$PATH" "$(asdf_data_dir)/shims")
+      path=$(remove_path_from_path "$PATH" "$ASDF_DATA_DIR/shims")
 
       executable_path=$(PATH=$path command -v "$shim_name")
 
diff --git a/test/shim_exec.bats b/test/shim_exec.bats
index 5c6d067..a46509c 100644
--- a/test/shim_exec.bats
+++ b/test/shim_exec.bats
@@ -38,7 +38,7 @@ teardown() {
   echo "dummy 1.0" >"$PROJECT_DIR/.tool-versions"
   run asdf install
 
-  path=$(echo "$PATH" | sed -e "s|$(asdf_data_dir)/shims||g; s|::|:|g")
+  path=$(echo "$PATH" | sed -e "s|$ASDF_DATA_DIR/shims||g; s|::|:|g")
   run env PATH="$path" which dummy
   [ "$output" = "" ]
   [ "$status" -eq 1 ]
diff --git a/test/test_helpers.bash b/test/test_helpers.bash
index 8a23931..7622f27 100644
--- a/test/test_helpers.bash
+++ b/test/test_helpers.bash
@@ -13,7 +13,19 @@ setup_asdf_dir() {
   fi
 
   HOME="$BASE_DIR/home"
+
+  # Internal Variables
+  get_asdf_tool_versions_filename
+  ASDF_DEFAULT_TOOL_VERSIONS_FILENAME=$REPLY
+
+  get_asdf_config_file
+  ASDF_CONFIG_FILE=$REPLY
+
+  get_asdf_data_dir
+  ASDF_DATA_DIR="$REPLY"
+
   ASDF_DIR="$HOME/.asdf"
+
   mkdir -p "$ASDF_DIR/plugins"
   mkdir -p "$ASDF_DIR/installs"
   mkdir -p "$ASDF_DIR/shims"
@@ -109,5 +121,5 @@ clean_asdf_dir() {
 
 setup_repo() {
   cp -r "$BATS_TEST_DIRNAME/fixtures/dummy_plugins_repo" "$ASDF_DIR/repository"
-  touch "$(asdf_dir)/tmp/repo-updated"
+  touch "$ASDF_DIR/tmp/repo-updated"
 }
diff --git a/test/utils.bats b/test/utils.bats
index 39f29eb..1315a23 100644
--- a/test/utils.bats
+++ b/test/utils.bats
@@ -187,20 +187,18 @@ teardown() {
   [ "$output" = "0.2.0|ASDF_DUMMY_VERSION environment variable" ]
 }
 
-@test "asdf_data_dir should return user dir if configured" {
+@test "get_asdf_data_dir should return user dir if configured" {
   ASDF_DATA_DIR="/tmp/wadus"
 
-  run asdf_data_dir
-  [ "$status" -eq 0 ]
-  [ "$output" = "$ASDF_DATA_DIR" ]
+  get_asdf_data_dir
+  [ "$REPLY" = "$ASDF_DATA_DIR" ]
 }
 
-@test "asdf_data_dir should return ~/.asdf when ASDF_DATA_DIR is not set" {
+@test "get_asdf_data_dir should return ~/.asdf when ASDF_DATA_DIR is not set" {
   unset ASDF_DATA_DIR
 
-  run asdf_data_dir
-  [ "$status" -eq 0 ]
-  [ "$output" = "$HOME/.asdf" ]
+  get_asdf_data_dir
+  [ "$REPLY" = "$HOME/.asdf" ]
 }
 
 @test "check_if_plugin_exists should work with a custom data directory" {
